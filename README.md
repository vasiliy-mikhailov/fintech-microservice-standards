# **Стандарт микросервисов. Версия X.Y**  
**Дата:** 2025-01-01  
**Владелец стандарта:** CIO  
**Статус:** Обязателен для всех новых и перерабатываемых систем  

---

## 1. Цели и область применения
Стандарт устанавливает обязательные требования к проектированию, разработке и эксплуатации микросервисов в крупной финансовой организации. Документ обеспечивает единообразие архитектурных подходов для систем, поддерживающих банковские операции, отличающиеся высокой критичностью, стабильностью процессов и строгими требованиями к доступности, безопасности и качеству данных. Стандарт применяется ко всем микросервисам, разрабатываемым внутри организации или проходящим существенную модернизацию в период 2025–2027 гг.

---

## 2. Предусловия
В организации действуют формализованные бизнес-сервисы, имеющие бизнес-владельцев, которые определяют ценность создаваемых процессов. Данные порождаются в ходе выполнения бизнес-процессов и управляются их владельцами. ИТ-подразделение формирует команды, создающие микросервисы, обслуживающие конкретные бизнес-сервисы. Отдельные микросервисы могут использоваться несколькими сервисами одновременно; такие решения закрепляются в сегменте Core IT.

---

# 3. Принципы развития микросервисов (2025–2027)

> Каждый принцип содержит измеримые метрики, SLA/SLO, примеры, риски и методы контроля.  

---

## **3.1. Domain Isolation / Доменно-ориентированная изоляция**

| Раздел | Содержание |
|--------|-----------|
| **Мотивация** | Снижение связности, повышение устойчивости и независимости релизов. |
| **Метрики** | • % сервисов, имеющих собственную доменную модель ≥ 95%<br>• Количество кросс-доменных вызовов ≤ 2 на критический бизнес-флоу<br>• SLO: независимое развертывание — ≥ 90% релизов без зависимостей |
| **Положительные примеры** | 1. Собственные модели данных<br>2. Ограничение API конкретным контекстом<br>3. Bounded context<br>4. Независимые пайплайны CI/CD<br>5. Ответственность ≤ 1 бизнес-способность |
| **Отрицательные примеры** | 1. Общие схемы БД<br>2. Разделяемые DTO<br>3. Ломающие изменения при релизах<br>4. Неформализованные контракты<br>5. Единая БД для нескольких сервисов |
| **Риски нарушения** | Каскадные отказы, рост сложности изменений |
| **Методика проверки** | Анализ зависимостей, статический анализ моделей, аудит релизных блокировок |
| **Статус** | **CORE** |

---

## **3.2. Zero Trust by Design / Безопасность Zero Trust**

| Раздел | Содержание |
|--------|-----------|
| **Мотивация** | Противодействие финансовому мошенничеству, снижение рисков компрометации. |
| **Метрики** | • 100% сервисов используют mTLS<br>• Token lifetime ≤ 15 минут<br>• 100% запросов проходят авторизацию<br>• SLA Security Incident MTTR ≤ 2 часа |
| **Положительные примеры** | 1. Проверка токенов в каждом вызове<br>2. Security в CI/CD<br>3. Минимальные привилегии<br>4. Secrets в vault<br>5. Авто-ротация сертификатов |
| **Отрицательные примеры** | 1. Долгоживущие токены<br>2. Общие сервисные аккаунты<br>3. Незашифрованные запросы<br>4. Ключи в коде<br>5. Открытые ingress |
| **Риски нарушения** | Утечки данных, финансовые потери |
| **Методика проверки** | Security-сканеры, IAM-аудит, пен-тесты |
| **Статус** | **CORE** |

---

## **3.3. API Contract Stability / Стабильность API-контрактов**

| Раздел | Содержание |
|--------|-----------|
| **Мотивация** | Минимизация интеграционных рисков. |
| **Метрики** | • Backward compatibility ≥ 99%<br>• Contract tests ≥ 90% API<br>• SLA API availability ≥ 99.95% |
| **Положительные примеры** | 1. Версионирование<br>2. Contract-first<br>3. JSON-schema/Protobuf<br>4. Генерация клиентов<br>5. Changelog |
| **Отрицательные примеры** | 1. Ломающие изменения<br>2. Контракты вне репозитория<br>3. Удаление полей без уведомления<br>4. Несогласованные типы<br>5. Нет контрактных тестов |
| **Риски нарушения** | Массовые инциденты |
| **Методика проверки** | API diff, CI-проверки контрактов |
| **Статус** | **CORE** |

---

## **3.4. Event-Driven Consistency / Событийная согласованность**

| Раздел | Содержание |
|--------|-----------|
| **Мотивация** | Согласованность данных в распределенных системах. |
| **Метрики** | • Guaranteed delivery ≥ 99.99%<br>• Event latency ≤ 200 мс<br>• Идемпотентность — 100% корректной обработки повторов |
| **Положительные примеры** | 1. Outbox<br>2. Идемпотентные хендлеры<br>3. Kafka с транзакциями<br>4. Версионирование событий<br>5. DLQ |
| **Отрицательные примеры** | 1. Потеря событий<br>2. Дубли без обработки<br>3. Неоднозначные схемы<br>4. Латентность > 1 с<br>5. Нет DLQ |
| **Риски нарушения** | Несогласованные данные, регуляторные риски |
| **Методика проверки** | Метрики Kafka, тесты идемпотентности |
| **Статус** | **CORE** |

---

## **3.5. Observability 360° / Полная наблюдаемость**

| Раздел | Содержание |
|--------|-----------|
| **Мотивация** | Быстрое выявление и устранение инцидентов. |
| **Метрики** | • 100% сервисов имеют логи/метрики/трейсы<br>• MTTR ≤ 30 мин<br>• Error budget ≥ 99%<br>• 0 алертов старше 24 ч |
| **Положительные примеры** | 1. OpenTelemetry<br>2. Корреляционные ID<br>3. SLO для API<br>4. Trace sampling ≥ 10%<br>5. Алерты по латентности |
| **Отрицательные примеры** | 1. Логи без контекста<br>2. Нет трассировки<br>3. Нет дашбордов<br>4. Ручное управление алертами<br>5. Нарушение SLO без RCA |
| **Риски нарушения** | Долгие простои |
| **Методика проверки** | APM-аудит, тесты алертов |
| **Статус** | **CORE** |

---

## **3.6. Autonomous Deployment / Автономные поставки**

| Раздел | Содержание |
|--------|-----------|
| **Мотивация** | Сокращение Time-to-Market и взаимных блокировок. |
| **Метрики** | • Deployment frequency ≥ 1/нед<br>• Независимые релизы ≥ 90%<br>• Lead time ≤ 1 день<br>• Успешные деплои ≥ 99% |
| **Положительные примеры** | 1. GitOps<br>2. Canary<br>3. Blue-Green<br>4. Тесты ≥ 80% покрытия<br>5. Автоматические миграции |
| **Отрицательные примеры** | 1. Ручные деплои<br>2. Деплой через SSH<br>3. Ночные релизные окна<br>4. Блокировки зависимостей<br>5. Нет CI-валидаторов |
| **Риски нарушения** | Ошибки из-за ручного управления |
| **Методика проверки** | CI/CD аналитика, аудит GitOps |
| **Статус** | **CORE** |

---

## **3.7. Performance & SLA Discipline / Дисциплина производительности и SLA**

| Раздел | Содержание |
|--------|-----------|
| **Мотивация** | Выполнение требований финтеха к скорости и доступности. |
| **Метрики** | • Availability ≥ 99.95%<br>• P95 latency ≤ 150 мс<br>• Error rate ≤ 0.1%<br>• Capacity margin ≥ 30% |
| **Положительные примеры** | 1. Автотесты производительности<br>2. Масштабирование<br>3. Кэширование<br>4. Rate limiting<br>5. Capacity review |
| **Отрицательные примеры** | 1. Нет NFR<br>2. Пики > 1 с<br>3. Нет стресс-тестов<br>4. Перегрузки<br>5. Неоптимальные запросы |
| **Риски нарушения** | SLA-штрафы |
| **Методика проверки** | Нагрузочные тесты, мониторинг latency/error |
| **Статус** | **CORE** |

---

## **3.8. Data Ownership & Quality / Владение и качество данных**

| Раздел | Содержание |
|--------|-----------|
| **Мотивация** | Соответствие банковским регуляциям и требованиям точности данных. |
| **Метрики** | • Data freshness ≤ 1 мин<br>• Completeness ≥ 99.9%<br>• Data lineage ≥ 95%<br>• Ошибки в данных ≤ 0.01% |
| **Положительные примеры** | 1. Ясные владельцы данных<br>2. Quality-чекеры в CI/CD<br>3. Schema registry<br>4. Аудит изменений<br>5. Версионирование |
| **Отрицательные примеры** | 1. Несогласованные схемы<br>2. Ручные правки БД<br>3. Дубли без стратегии<br>4. Нет lineage<br>5. Неизвестные источники данных |
| **Риски нарушения** | Ошибки отчётности, регуляторные санкции |
| **Методика проверки** | Data quality-сканеры, проверка схем |
| **Статус** | **CORE** |

---

## **3.9. Cloud-Native Efficiency / Эффективность Cloud-Native решений**

| Раздел | Содержание |
|--------|-----------|
| **Мотивация** | Оптимизация затрат и унификация инфраструктуры. |
| **Метрики** | • Utilization ≥ 50%<br>• Cold start ≤ 200 мс<br>• Образ ≤ 200 МБ<br>• MTTR инфраструктуры ≤ 20 мин |
| **Положительные примеры** | 1. Sidecar-паттерны<br>2. Distroless<br>3. Автомасштабирование<br>4. Multi-AZ<br>5. IaC 100% |
| **Отрицательные примеры** | 1. Ручная настройка<br>2. Образы > 1 ГБ<br>3. Single-AZ<br>4. Нет IaC<br>5. Нет лимитов/requests |
| **Риски нарушения** | Рост стоимости, падения инфраструктуры |
| **Методика проверки** | Kubernetes-аналитика, аудит IaC |
| **Статус** | OPTIONAL |

---

## **3.10. AI-Augmented Engineering / Автоматизация через ИИ**

| Раздел | Содержание |
|--------|-----------|
| **Мотивация** | Повышение качества и скорости разработки. |
| **Метрики** | • AI-code analysis ≥ 90% покрытия<br>• Code review ≤ 12 ч<br>• Применение рекомендаций ≥ 70% |
| **Положительные примеры** | 1. AI-autocomplete<br>2. Генерация тестов<br>3. Авто-RCA<br>4. Оптимизация запросов<br>5. ChatOps |
| **Отрицательные примеры** | 1. Использование ИИ без проверки<br>2. Слабые автоген-тесты<br>3. Игнорирование предупреждений ИИ<br>4. Неконтролируемые модели<br>5. Нет журнала рекомендаций |
| **Риски нарушения** | Ошибки кода, утечки данных |
| **Методика проверки** | Логи AI-инструментов, аудит CI |
| **Статус** | OPTIONAL |

---

# 4. Заключение
Настоящий стандарт обязателен к исполнению всеми командами разработки и эксплуатации в период 2025–2027 гг. Соблюдение стандарта является частью архитектурного контроля, аудита и процесса принятия проектных решений.
